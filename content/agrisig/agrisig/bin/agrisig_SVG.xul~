<?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
<?xml-stylesheet href="chrome://agrisig/skin/barre_carte.css" type="text/css"?>
<?xml-stylesheet href="chrome://agrisig/skin/icons.css" type="text/css"?>
<?xml-stylesheet href="chrome://agrisig/skin/icons2.css" type="text/css"?>
<?xml-stylesheet href="chrome://browser/skin" type="text/css"?>
<window
    id="AgriSig_Window"
    title="AgriSIG"
    orient="vertical"
    sizemode="maximized"
    onload="agrisig_start();"
    width="1100"
    height="800"
    xmlns:html="http://www.w3.org/1999/xhtml"
    xmlns:svg="http://www.w3.org/2000/svg"
    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
  <?xul-overlay	href="agrisig_overlay.xul"?>



  <script src="preference.js"/>
  <script src="SaisieFloat.js"/>
  <script src="cartesvg.js"/>
  <script src="cartesvg_sql.js"/>
  <script src="agrisig.js"/>
  <script src="agrisig_SVG.js"/>
  <script src="export.js"/>
  <script src="../lib/libIO.js"/>
<!--
  <script src="pgsql.js"/>
  <script src="utils_xul.js"/>
  <script src="onglet_Contraintes.js"/>
-->




  <!--<button label="Taille Iframe" oncommand="GetTailleIframe()"/>-->
  <!-- Menu + toolbar  style="padding:10px; border:2px solid red" -->

  <!-- ICI ON DEFINIT L'ENSEMBLE DES MENU POPUP -->
  <popupset>
    <popup id="Popup_Fermer_Onglet">
    <menuitem label="Fermer" oncommand="alert('A debugger car suppr. onglet actif');FermerOnglet();" />
    </popup>
  </popupset>

  <toolbox align="stretch" orient="vertical">
    <toolbar type="menubar" customizable="true" class="chromeclass-menubar">
      <toolbaritem align="center">
        <menubar id="menu-application" orient="horizontal">
          <menu id="file-menu" label="Fichier">
            <menupopup>
              <menuitem label="S'identifier" oncommand="pgsql_deco();agrisig_start()"/>
              <menuitem label="Gérer les utilisateurs" id="menu-user" oncommand="agrisig_user();"/>
              <menuseparator/>
              <menuitem label="Nettoyer les sous-ilots de la base" oncommand="sousilot_clean();"/>
              <menuseparator/>
              <menuitem label="Se connecter"          oncommand="pgsql_init(true);"/>
              <menuitem label="Se déconnecter"        oncommand="pgsql_deco();"/>
              <menuitem label="Configurer les alias"  oncommand="pgsql_configaliases();"/>
              <menuseparator />
              <menuitem id="fichier-importer" label="Importer..." oncommand="window.openDialog('import.xul','showmore','centerscreen,modal,chrome');"/>
<!--           <menuitem label="Test Requete" oncommand="carte_querypolygones();"/>-->
              <menuseparator />
              <menuitem label="Quitter" oncommand="FermerAppli();"/>
            </menupopup>
          </menu>
          <menu id="edition-menu" label="Edition">
            <menupopup id="edit-popup">
              <menuitem label="Couper" />
              <menuitem label="Copier" />
              <menuitem label="Coller" />
              <menuseparator />
              <menuitem label="Rechercher" oncommand="toto();"/>
            </menupopup>
          </menu>

          <menu id="donnee-menu" label="Gestions des Données">
            <menupopup id="donnee-popup">
              <menu label="Contraintes">
                <menupopup>
                  <menuitem label="Vérification" oncommand="addOnglet('Contraintes');"/>
                  <menuitem label="Générateur" oncommand="addOnglet('GenContraintes');"/>
                </menupopup>
              </menu>
              <menuseparator />
<!--
              <menuitem label="Gestion des données" oncommand='window.openDialog("chrome://agrisig/content/Onglets/Agrisig/Interface.xul")'/>
              <menuitem label="Adresses" oncommand="addOnglet('Adresses');" />
              <menuitem label="Communes" oncommand="addOnglet('Communes');" />
              <menuitem label="Composants" oncommand="addOnglet('Composants');" />
              <menuitem label="Contacts" oncommand="addOnglet('Contacts');" />
              <menuitem label="Coordonnées personnel" oncommand="addOnglet('Coordonnees');"/>
              <menuitem label="Coordonnées Ilot" oncommand="addOnglet('Ilots');"/>
              <menuitem label="Codes Postaux" oncommand="addOnglet('Codes postaux');" />
              <menuitem label="Descriptions" oncommand="addOnglet('Descriptions');" />
              <menuitem label="Familles de produits" oncommand="addOnglet('Familles de produits');" />
              <menuitem label="Familles de profils" oncommand="addOnglet('Familles de profils');" />
              <menuitem label="Firmes" oncommand="addOnglet('Firmes');" />
              <menuitem label="Personnes" oncommand="addOnglet('Personnes');" />
              <menuitem label="Produits" oncommand="addOnglet('Produits');" />
              <menuitem label="Profils" oncommand="addOnglet('Profils');" />
              <menuitem label="Stocks" oncommand="addOnglet('Stocks');" />
              <menuitem label="Tiers" oncommand="addOnglet('Tiers');" />
              <menuitem label="Type de tiers" oncommand="addOnglet('Type de tiers');" />
	  		-->
            </menupopup>
          </menu>
          <menu id="menu-preference" label="Préférences">
            <menupopup>
              <menuitem label="Configuration de l'application" oncommand="window.openDialog('preference.xul','showmore','centerscreen,chrome,modal');"/>
              <menuitem label="Coordonnées personnelles" oncommand="addOnglet('Coordonnees');"/>
              <menuitem label="Coordonnées Ilot" oncommand="addOnglet('Ilots');"/>
            </menupopup>
          </menu>
          <menu id="menu-etat" label="Etats">
            <menupopup>
  <!--        <menuitem label="Etats" oncommand="addOnglet('Etats');"/>  -->
              <menuitem label="Générateur d'états" oncommand='window.openDialog("chrome://agrisig/content/gen_vue.xul")' />
            </menupopup>
          </menu>
          <menu id="menu-aide" label="Aide">
            <menupopup>
              <menuitem label="Javascript Debugger" oncommand="window.open('chrome://venkman/content/','JavaScript Debugger','chrome,centerscreen,resizable');"/>
              <menuseparator />
              <menuitem label="Aide générale"/>
              <menuitem label="Aide sur l'onglet en cours"/>
            </menupopup>
          </menu>
        </menubar>
      </toolbaritem>
      <toolbarspring flex="1"/>
      <toolbaritem id="throbber-box" title="Indicateur d'activité" align="center" pack="center">
        <button id="navigator-throbber" oncommand="goClickThrobber('browser.throbber.url', event)" onclick="checkForMiddleClick(this, event);" tooltiptext="Aller à la page de démarrage"/>
      </toolbaritem>
    </toolbar>

    <toolbar align="center" flex="1">
      <toolbarbutton id="back-button" type="menu-button" class="toolbarbutton-1 chromeclass-toolbar-additional" oncommand="alert('Non implémenté')" tooltiptext="Annuler la dernière action"/>
      <toolbarbutton id="reload-button" class="toolbarbutton-1 chromeclass-toolbar-additional" tooltiptext="Rafaichir l'affichage"/>
      <toolbarbutton tooltiptext="Carte" id="home-button" class="toolbarbutton-1 chromeclass-toolbar-additional"/>
      <toolbaritem align="center" flex="1">
        <label value="Couche de travail"/>
        <menulist id="tab-couche-travail" flex="1" oncommand="tab_couche_travail_select();">
          <menupopup id="tab-couche-travail-popup" datasources="rdf:null" ref="SQL:ResultRoot">
            <hbox equalsize="always" class="menulistheader">
              <label value="Couche" flex="1"/>
              <label value="Type" flex="1"/>
            </hbox>
            <template>
              <menuitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#cc_nom" value="rdf:http://www.mozilla.org/SQL-rdf#cc_numero" equalsize="always">
                <label value="rdf:http://www.mozilla.org/SQL-rdf#cc_nom" flex="1"/>
                <label value="rdf:http://www.mozilla.org/SQL-rdf#tc_nom" flex="1"/>
              </menuitem>
            </template>
          </menupopup>
        </menulist>
        <toolbarbutton id="go-button" label="Valider" oncommand="tab_couche_travail_valide();"/>
        <button label="Gérer" oncommand="alert('Non implémenté');"/>
        <checkbox id="tab-couche-travail-version-checkbox" label="Voir aussi la version" oncommand="svg_refresh();"/>
        <menulist id="tab-couche-travail-version-list" seltype="single" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" oncommand="svg_refresh();">
          <template>
            <menupopup>
              <menuitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#cc_version" value="rdf:http://www.mozilla.org/SQL-rdf#cc_numero"/>
            </menupopup>
          </template>
        </menulist>
      </toolbaritem>
    </toolbar>
  </toolbox>


  <hbox flex="1">


    <tabbox id="Main_Tabbox" flex="1">

      <hbox id="box_overflow">
        <tabs id="Tous_les_onglets" onselect="MAJOnglet(selectedItem);" closebutton="true" onclosetab="alert('Pas implémenté. Désolé.');">
          <tab id="onglet_Carte" label="Carte"/>
        </tabs>
      </hbox>

      <tabpanels id="Tous_les_panels" flex="1">
        <tabpanel orient="vertical" flex="1">
	  <arrowscrollbox orient="horizontal">
  <!--      <toolbarbutton id="carte_load"  label="INIT"   checked="false" autoCheck="true" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Init" disabled="false"/>-->
            <toolbarbutton id="carte_centrer" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Centrer la vue sur les sous-îlots" disabled="true"/>
            <toolbarbutton id="carte_centrer_select" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Centrer la vue sur le sous-îlot sélectionné" disabled="true"/>
            <toolbarbutton id="textes" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Activer/désactiver l'affichage du nom des sous-ilots" disabled="false" label="TXT"/>
            <toolbarbutton id="carte_zoomP" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Zoom +" disabled="true"/>
            <toolbarbutton id="carte_zoomM" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Zoom -" disabled="true"/>
            <toolbarbutton id="carte_ref" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Définir le point de référence" disabled="true"/>
            <toolbarbutton id="carte_PtOff" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Masquer les points" disabled="true"/>
            <toolbarbutton id="carte_PtOn" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Affiche les points" disabled="true"/>
            <toolbarspacer/>
            <toolbarbutton id="carte_verr0" selected="true" checked="true" autoCheck="true" type="radio" group="2" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Pas de verrouillage" disabled="false" label="V0"/>
            <toolbarbutton id="carte_verr1" selected="false" checked="false" autoCheck="true" type="radio" group="2" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Verrouillage sur le point le plus proche du sous-îlot sélectionné" disabled="false" label="V1"/>
            <toolbarbutton id="carte_verr2" selected="false" checked="false" autoCheck="true" type="radio" group="2" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Verrouillage sur le point le plus proche" disabled="false" label="V2"/>
            <toolbarspacer/>
            <toolbarbutton id="carte_annuler"     checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Annule l'action en cours" disabled="true"/>
<!--
            <toolbarbutton id="carte_zoomPC"     checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Zoom + centré"/>
            <toolbarbutton id="carte_zoomMC"     checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Zoom - centré"/>
            <toolbarbutton id="carte_dplt"      checked="false" autoCheck="true" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Deplacement"/>
-->
            <toolbarspacer/>
            <toolbarbutton id="carte_distance" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Calculer la distance entre un point et sa perpendiculaire sur un côté" disabled="true"/>
            <toolbarbutton id="carte_insertion" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Inserer un point sur un segment" disabled="true"/>
            <toolbarbutton id="carte_perpend" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Inserer un point perpendiculairement à un segment" disabled="true"/>
            <toolbarbutton id="carte_parall" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Inserer un point parallèlement à un segment" disabled="true"/>
<!--
            <toolbarbutton id="carte_angle" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Définir un angle de référence" disabled="false" label="a"/>
-->
            <toolbarspacer/>
            <toolbarbutton id="carte_cercle" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Tracer un cercle" disabled="true"/>
            <toolbarbutton id="carte_bande" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Tracer une bande" disabled="true"/>
            <toolbarbutton id="carte_bande_supprimer_pt" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Supprimer un point de la bande" disabled="true" label="S"/>
            <toolbarbutton id="carte_bande_fin" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Valider le tracé de la bande" disabled="true" label="V"/>
            <toolbarspacer/>
            <toolbarbutton id="carte_DivSimple" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Diviser un sous-îlot en deux à partir de 2 points" disabled="true"/>
            <toolbarbutton id="carte_DivComplexe" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Diviser un sous-îlot" disabled="true"/>
            <toolbarbutton id="carte_DivComplexeSelectBande" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Sélectionner une bande de points existants dans le sous-îlot à diviser" disabled="true"/>
            <toolbarbutton id="carte_DivComplexeAjPt" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Ajouter un point supplémentaire dans le sous-îlot à diviser" disabled="true"/>
            <toolbarbutton id="carte_DivComplexeSuppPt" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Supprimer le dernier point ajouté dans le sous-îlot à diviser" disabled="true"/>
            <toolbarbutton id="carte_DivComplexeFin" checked="false" autoCheck="false" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Fin du détourage avancé" disabled="true"/>
<!--
            <toolbarbutton id="carte_test" label="TEST" checked="false" autoCheck="true" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="Divise un sous ilot en deux"/>
            <toolbarbutton id="carte_creerilot" checked="true"  autoCheck="true" type="radio" group="1" onmouseover="AfficherAide(this);" oncommand="ChangerOutils(this);" tooltiptext="creerilot"/>
-->
	  </arrowscrollbox>
	  <separator class="groove-thin"/>
          <hbox flex="1">

            <!-- Onglet gauche -->
            <vbox pack="center">

	      <vbox>
                <hbox align="center"> 
                  <label control="date-travail" value="Date de travail"/>
                  <textbox id="date-travail" flex="1" value="03/04/2005" onblur="date_travail_change();"/>
                  <toolbarbutton id="go-button" label="Valider" oncommand="date_travail_change();"/>
                </hbox>
                <hbox align="center"> 
                  <label control="sousilot-selection-list" value="Sélection du sous-îlot"/>
		  <menulist id="sousilot-selection-list" seltype="single" flex="1" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" oncommand="sousilot_selection_select(this);">
                    <template>
                      <menupopup>
                        <menuitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#si_libelle" value="rdf:http://www.mozilla.org/SQL-rdf#si_numero"/>
                      </menupopup>
                    </template>
                  </menulist>
                </hbox>	      
	      </vbox>

              <tabbox flex="1">
                <tabs>
		  <tab label="Sous-ilot"/>
		  <tab label="Ilot"/>
		  <tab label="Actions"/>
                </tabs>
                <tabpanels flex="1">
	
  <!-- ONGLET SOUS-ILOT -->
                  <tabpanel orient="vertical">
                    <vbox flex="1">
                      <vbox>
		        <label hidden="true" id="tab_info_si"/>
                        <grid>
                          <columns>
                            <column />
                            <column flex="1" />
                          </columns>
                          <rows>
                            <label id="tab-sousilot-numero" hidden="true"/>
                            <row  align="center">
                              <label control="tab-sousilot-nom" value="Nom"/>
                              <textbox id="tab-sousilot-nom" disabled="true" value=""/>
                            </row>
                            <row  align="center">
                              <label value="Surface"/>
                              <hbox pack="start" align="center">
                                <label id="tab_sousilot_surface" value="-inconnu-"/>
                                <menulist id="tab_sousilot_list" flex="1" oncommand="tab_sousilot_unite()">
                                  <menupopup>
                                    <!-- L'ordre est nécessaire pour le bon fonctionnement -->
                                    <!-- Il faut changer le numero des constantes Js pour modifier l'ordre ici -->
                                    <menuitem id="tab_sousilot_surface_m2" label="m²"/>
                                    <menuitem id="tab_sousilot_surface_ha" label="Hectares" selected="true"/>
                                    <menuitem id="tab_sousilot_surface_are" label="Ares"/>
                                    <menuitem id="tab_sousilot_surface_km2" label="Km²"/>
                                  </menupopup>
                                </menulist>
                              </hbox>
                            </row>
                            <row>
                              <label value="Périmètre"/>
                              <hbox>
                                <label id="tab-sousilot-perimetre"/>
                                <label value="mètres"/>
                              </hbox>
                            </row>
                            <row>
                              <label value="Date de création" control="tab-sousilot-creation"/>
                              <textbox id="tab-sousilot-creation"/>
                            </row>
                          </rows>
                        </grid>

			<hbox align="center">
                          <label value="Adresse" control="tab-sousilot-adresse-list"/>
                          <menulist disabled="true" id="tab-sousilot-adresse-list" flex="1" seltype="single" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content">
			    <template>
                              <menupopup>
			        <menuitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#ad_libelle" value="rdf:http://www.mozilla.org/SQL-rdf#ad_numero"/>
                              </menupopup>
                            </template>
	                  </menulist>
                          <button label="Gérer"/>
                        </hbox>

                        <hbox class="fondstyle" pack="end">
                          <button id="tab-sousilot-modifier" class="icon_Modifier" label="Modifier" oncommand="tab_sousilot_modifier();"/>
                          <button id="tab-sousilot-enregistrer" label="Enregistrer" hidden="true" oncommand="tab_sousilot_enregistrer();"/>
                          <button id="tab-sousilot-annuler" label="Annuler" hidden="true" oncommand="tab_sousilot_annuler();"/>
                        </hbox>
                      </vbox>
		      <!-- GROUPES AUXQUELS APPARTIENT LE SOUSILOT -->
		      <groupbox flex="1" orient="vertical">
                        <caption label="Groupes du sous-ilot"/>
                        <listbox id="tab-sousilot-groupe-list" flex="1" seltype="single" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content">
                          <template>
                            <listitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#gr_nom" value="rdf:http://www.mozilla.org/SQL-rdf#gr_numero"/>
                          </template>
                        </listbox>
                        <hbox align="center">
	                  <label value="Groupe"/>
                          <menulist id="tab-sousilot-groupe-selection-list" seltype="single" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" flex="1">
                            <template>
                              <menupopup>
                                <menuitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#gr_nom" value="rdf:http://www.mozilla.org/SQL-rdf#gr_numero" tooltiptext="rdf:http://www.mozilla.org/SQL-rdf#gr_nom - rdf:http://www.mozilla.org/SQL-rdf#note"/>
                              </menupopup>
                            </template>
                          </menulist>
			</hbox>
			<hbox class="fondstyle">
			  <hbox pack="start">
                            <button label="Gérer" oncommand="alert('Non implémenté');"/>
			  </hbox>
  		          <hbox pack="end" flex="1">
	 		    <button label="Rattacher" oncommand="tab_sousilot_rattacher_groupe();"/>
			    <button label="Détacher" oncommand="tab_sousilot_detacher_groupe();"/>
                          </hbox>
			</hbox>
                      </groupbox>
                    </vbox>
                  </tabpanel>

  <!-- ONGLET ILOT -->
                  <tabpanel orient="vertical">
                    <label id="tab-ilot-numero" hidden="true"/>
                    <vbox flex="1">
                      <vbox>
                        <grid>
                          <columns>
                            <column />
                            <column flex="1" />
                          </columns>
                          <rows>
                            <row  align="center">
                              <label control="tab-ilot-nom" value="Nom"/>
                              <textbox id="tab-ilot-nom" disabled="true"/>
                            </row>
                            <row  align="center">
                              <label control="tab-ilot-code" value="Code"/>
                              <textbox id="tab-ilot-code" disabled="true"/>
                            </row>
                            <row  align="center">
                              <label value="Surface"/>
                              <hbox pack="start" align="center">
                                <label id="tab_ilot_surface" value="-"/>
                                  <menulist id="tab_ilot_list" flex="1" oncommand="tab_ilot_unite()">
                                    <menupopup>
                                      <!-- L'ordre est nécessaire pour le bon fonctionnement -->
                                      <!-- Il faut changer le numero des constantes Js pour modifier l'ordre ici -->
                                      <menuitem id="tab_ilot_surface_m2" label="m²"/>
                                      <menuitem id="tab_ilot_surface_ha" label="Hectares" selected="true"/>
                                      <menuitem id="tab_ilot_surface_are" label="Ares"/>
                                      <menuitem id="tab_ilot_surface_km2" label="Km²"/>
                                    </menupopup>
                                  </menulist>
                                </hbox>
                              </row>
                              <row  align="center">
                                <label value="Référence"/>
                                <hbox pack="start" align="center">
                                  <label id="tab_ilot_surfaceref" value="-"/>
                                  <menulist id="tab_ilot_listref" flex="1" oncommand="tab_ilot_uniteref()">
                                    <menupopup>
                                    <!-- L'ordre est nécessaire pour le bon fonctionnement -->
                                    <!-- Il faut changer le numero des constantes Js pour modifier l'ordre ici -->
                                    <menuitem id="tab_ilot_surfaceref_m2" label="m²"/>
                                    <menuitem id="tab_ilot_surfaceref_ha" label="Hectares" selected="true"/>
                                    <menuitem id="tab_ilot_surfaceref_are" label="Ares"/>
                                    <menuitem id="tab_ilot_surfaceref_km2" label="Km²"/>
                                  </menupopup>
                                </menulist>
                              </hbox>
                            </row>
                            <row  align="center">
                              <label value="Perimètre"/>
                              <hbox>
                                <label id="tab-ilot-perimetre" value="-"/>
                                <label value="mètres"/>
                              </hbox>
                            </row>
                          </rows>
                        </grid>
			<hbox align="center">
                          <label value="Commune"/>
                          <menulist disabled="true" id="tab-ilot-commune-list" flex="1" seltype="single" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content">
			    <template>
                              <menupopup>
			        <menuitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#co_nom" value="rdf:http://www.mozilla.org/SQL-rdf#co_numero"/>
                              </menupopup>
                            </template>
	                  </menulist>
                          <button label="Gérer"/>
                        </hbox>

                        <hbox pack="end" class="fondstyle">
                          <button id="tab-ilot-modifier" label="Modifier" class="icon_Modifier" oncommand="tab_ilot_modifier();"/>
                          <button id="tab-ilot-enregistrer" label="Enregistrer" hidden="true" oncommand="tab_ilot_enregistrer();"/>
                          <button id="tab-ilot-annuler" label="Annuler" hidden="true" oncommand="tab_ilot_annuler();"/>
                        </hbox>
                      </vbox>
		      <vbox flex="1">
                        <groupbox flex="1">
                          <caption>
                            <label value="Sous-ilots de l'ilot"/>
                          </caption>
                          <tree id="tab-ilot-sousilot-tree" flex="1" seltype="single" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" onclick="tree_select_sousilot();">
                            <treecols>
                              <treecol label="Nom" flex="1" sort="rdf:http://www.mozilla.org/SQL-rdf#si_nom" sortActive="true"/>
                              <splitter class="tree-splitter"/>
                              <treecol label="Surface (Ha)" sort="rdf:http://www.mozilla.org/SQL-rdf#si_surface"/>
                            </treecols>
                            <template>
                              <treechildren>
                                <treeitem uri="rdf:*">
                                  <treerow>
                                    <treecell label="rdf:http://www.mozilla.org/SQL-rdf#si_nom" value="rdf:http://www.mozilla.org/SQL-rdf#si_numero"/>
                                    <treecell label="rdf:http://www.mozilla.org/SQL-rdf#si_surface" tooltiptext="rdf:http://www.mozilla.org/SQL-rdf#si_aire m²"/>
                                  </treerow>
                                </treeitem>
                              </treechildren>
                            </template>
                          </tree>
                        </groupbox>
                      </vbox>
                    </vbox>
                  </tabpanel>


  <!-- ONGLET ACTIONS -->
                  <tabpanel orient="vertical">
		    <tabbox id="action-tabbox" flex="1">
		      <tabs>
		        <tab label="Profils"/>
			<tab label="Récoltes"/>
			<tab label="Irrigations"/>
		      </tabs>
		      <tabpanels flex="1">
		        <tabpanel orient="vertical">
                          <listbox id="action-profil-list" flex="1" seltype="single" allowevents="true" suppressonselect="true" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" ondblclick="document.getElementById('action-voir').click()">
                            <template>
                              <listitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#pr_nom" 
                                 value="rdf:http://www.mozilla.org/SQL-rdf#pr_numero"/>
                            </template>
                          </listbox>
			  <label id="action-profil-count" value="0 profil(s)"/>
			</tabpanel>
		        <tabpanel orient="vertical">
                          <listbox id="action-recolte-list" flex="1" seltype="single" allowevents="true" suppressonselect="true" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" ondblclick="document.getElementById('action-voir').click()">
                            <template>
                              <listitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#re_libelle" 
                                 value="rdf:http://www.mozilla.org/SQL-rdf#re_numero"/>
                            </template>
                          </listbox>
			  <label id="action-recolte-count" value="0 récolte(s)"/>
			</tabpanel>
		        <tabpanel orient="vertical">
                          <listbox id="action-irrigation-list" flex="1" seltype="single" allowevents="true" suppressonselect="true" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" ondblclick="document.getElementById('action-voir').click()">
                            <template>
                              <listitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#pr_nom" 
                                 value="rdf:http://www.mozilla.org/SQL-rdf#pr_numero"/>
                            </template>
                          </listbox>
			  <label id="action-irrigation-count" value="0 irrigation(s)"/>
			</tabpanel>
		      </tabpanels>
		    </tabbox>
		    <hbox pack="end" class="fondstyle">
		      <button id="action-voir" label="Voir" onclick="alert('A faire! attention : ne pas oublier!');"/>
		      <button id="action-ajouter" label="Ajouter"/>
		    </hbox>
                  </tabpanel>
                </tabpanels>
              </tabbox>

<!-- DECALAGE INDENTATION -->

            <splitter collapse="after">
	      <grippy/>
	    </splitter>


  <!-- DESSOUS DU PANNEAU DE GAUCHE : Selection des couches -->
            <tabbox flex="1" id="tab">
              <tabs>
                <tab label="Couches"/>
                <tab label="Couleur"/>
                <tab label="Groupes"/>
              </tabs>
              <tabpanels flex="1">
<!-- TAB COUCHES -->
                <tabpanel orient="vertical">
                  <label value="Couches affichées :"/>
                  <listbox id="tab-couche-list" flex="1" seltype="single" allowevents="true" suppressonselect="true" hidecolumnpicker="false" datasources="rdf:null" ref="SQL:ResultRoot" ondblclick="tab_couche_display();" flags="dont-build-content" onclick="tab_couche_list_select();" minheight="40">
                    <template>
                      <listitem uri="rdf:*" type="checkbox" checked="false" 
		        label="rdf:http://www.mozilla.org/SQL-rdf#cc_nom (rdf:http://www.mozilla.org/SQL-rdf#tc_nom^)" 
                        value="rdf:http://www.mozilla.org/SQL-rdf#cc_numero" 
                        tooltiptext="rdf:http://www.mozilla.org/SQL-rdf#cc_nom"/>
                    </template>
                  </listbox>
		  <hbox>
		  </hbox>
                </tabpanel>
<!-- TAB COULEURS -->
                <tabpanel orient="vertical">
                  <hbox align="center">
                    <label control="tab-couleur-list" value="Colorier par"/>
                    <menulist id="tab-couleur-list" seltype="single" flex="1" oncommand="tab_couleur_legende_refresh();">
                      <menupopup id="tab-couleur-popup"/>
                    </menulist>
                  </hbox>
                  <label value="Légende :"/>
                  <listbox id="tab-couleur-legende" flex="1" seltype="single" allowevents="true" suppressonselect="true" hidecolumnpicker="false" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" style="overflow:auto"  minheight="40">
                    <template>
                      <listitem uri="rdf:*" value="rdf:http://www.mozilla.org/SQL-rdf#xx_numero">
                        <hbox align="center">
                          <deck>
                            <colorpicker type="button" value="rdf:http://www.mozilla.org/SQL-rdf#couleur" pkey="rdf:http://www.mozilla.org/SQL-rdf#xx_numero" onchange="tab_couleur_legende_enregistre(this);"/>
                          </deck>
	                  <label flex="1" value="rdf:http://www.mozilla.org/SQL-rdf#xx_nom"/>
                        </hbox> 
                      </listitem>
                    </template>
                  </listbox>
                </tabpanel>


<!-- TAB GROUPES -->
                <tabpanel orient="vertical">
		  <hbox align="center">
                    <label value="Groupe"/>
                    <menulist id="tab-groupe-list" seltype="single" flex="1" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" oncommand="tab_groupe_sousilot_list_refresh();">
                      <template>
                        <menupopup>
                          <menuitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#gr_nom" value="rdf:http://www.mozilla.org/SQL-rdf#gr_numero"/>
                        </menupopup>
                      </template>
                    </menulist>
		  </hbox>
                  <label value="Sous-ilots :"/>
                  <listbox id="tab-groupe-sousilot-list" flex="1" seltype="single" datasources="rdf:null" ref="SQL:ResultRoot" flags="dont-build-content" onselect="if (document.getElementById('tab-groupe-autoselect').checked) list_select_sousilot(this);" minheight="40">
                    <template>
                      <listitem uri="rdf:*" label="rdf:http://www.mozilla.org/SQL-rdf#si_libelle" value="rdf:http://www.mozilla.org/SQL-rdf#si_numero"/>
                    </template>
                  </listbox>
		  <hbox pack="end" class="fondstyle">
                    <hbox pack="start">
		      <checkbox id="tab-groupe-autoselect" label="Sélection automatique"/>
                    </hbox>
                    <hbox pack="end" flex="1">
		      <button label="Ajouter"   oncommand="tab_groupe_ajouter_sousilot();"/>
		      <button label="Supprimer" oncommand="tab_groupe_supprimer_sousilot();"/>
                    </hbox>
		  </hbox>
                </tabpanel>







              </tabpanels>
            </tabbox>
          </vbox>



          <splitter collapse="before">
	    <grippy/>
	  </splitter>



          <vbox flex="1">







              <!-- Carte SVG -->
            <iframe id="carteSVG" name="FrameTab" flex="3" src="cartesvg.xml" style="overflow:hidden"/>



	    <splitter collapse="after">
	      <grippy/>
	    </splitter>




          <!-- Informations du bas -->
            <hbox>
	      <hbox orient="horizontal">
	        <!--<caption label="Déplacement"/>-->
                <grid>
	          <columns>
                    <column/>
                    <column/>
                    <column/>
                  </columns>
	          <rows>
                    <row>
		      <toolbarbutton class="icon_multidir_hg" oncommand="svg_deplacement(1*document.getElementById('deplacement-pas').value,-1*document.getElementById('deplacement-pas').value);"/>
		      <toolbarbutton class="icon_multidir_h" oncommand="svg_deplacement(0,-1*document.getElementById('deplacement-pas').value);"/>
		      <toolbarbutton class="icon_multidir_hd" oncommand="svg_deplacement(-1*document.getElementById('deplacement-pas').value,-1*document.getElementById('deplacement-pas').value);"/>
                    </row>
                    <row>
                      <toolbarbutton class="icon_multidir_g" oncommand="svg_deplacement( 1*document.getElementById('deplacement-pas').value, 0*1);"/>
		      <toolbarbutton class="icon_multidir_centre" oncommand="ChangerOutils(document.getElementById('carte_centrer'));"/>
		      <toolbarbutton class="icon_multidir_d" oncommand="svg_deplacement(-1*document.getElementById('deplacement-pas').value, 0*1);"/>
                    </row>
                    <row>
		      <toolbarbutton class="icon_multidir_bg" oncommand="svg_deplacement(1*document.getElementById('deplacement-pas').value, 1*document.getElementById('deplacement-pas').value);"/>
		      <toolbarbutton class="icon_multidir_b" oncommand="svg_deplacement(0, 1*document.getElementById('deplacement-pas').value);"/>
		      <toolbarbutton class="icon_multidir_bd" oncommand="svg_deplacement(-1*document.getElementById('deplacement-pas').value, 1*document.getElementById('deplacement-pas').value);"/>
		    </row>
	          </rows>
	        </grid>
		<vbox align="left" pack="start" flex="1">
                  <label control="deplacement-pas" value="Pas :"/>
                  <textbox id="deplacement-pas" value="100" width="60"/>
                </vbox>
	      </hbox>
	      <splitter collapse="before"/>
              <vbox flex="1">
                <grid>
                  <columns>
                    <column/>
                    <column/>
                    <column/>
                    <column/>
                  </columns>
                  <rows>
                    <row align="center">
                      <label value="Coordonnées"/>
                      <hbox>
                        <label value="X :"/>
                        <label id="lb_coord_x" value="0" minwidth="10"/>
                        <label value="m"/>
                      </hbox>  
                      <label value="Zoom :"/>
                      <label id="tab_info_zoom" value="1:10"/>
                    </row>
                    <row align="center">
                      <label value="" />
                      <hbox>
                        <label value="Y :"/>
                        <label id="lb_coord_y" value="0" minwidth="10"/>
                        <label value="m"/>
                      </hbox>  
                    </row>
                    <row align="center">
                      <label value="Angle au centre :"/>
                      <hbox>
                        <label id="lb_angle" value="0"/>
                        <label value="degrés"/>
                      </hbox>  
                      <label value="Distance au centre :"/>
                      <hbox>
                        <label id="lb_distance" value="0"/>
                        <label value="m"/>
                      </hbox>  
                    </row>
                    <row align="center">
                      <label value="Distance n°1 :"/>
                      <hbox>
                        <label id="tab_distance1" value="0"/>
                        <label value="m"/>
                      </hbox>  
                      <label value="Distance n°2 :"/>
                      <hbox>
                        <label id="tab_distance2" value="0"/>
                        <label value="m"/>
                      </hbox>  
                    </row>
                  </rows>
                </grid>
              </vbox>
              </hbox>
	    </vbox>
          </hbox>
        </tabpanel>



      </tabpanels>
    </tabbox>

    <!-- *************************** -->

    <splitter collapse="after">
      <grippy/>
    </splitter>

    <!-- ****** PAGE DE DROITE ***** -->

    <vbox collapsed="true">
      <tabbox flex="1">
        <tabs>
          <tab label="Aide"/>
          <tab label="Tutorial"/>
        </tabs>
        <tabpanels flex="1">
          <tabpanel id="Outils-panel" orient="vertical">
            <iframe id="FrameAide" name="FrameAide" src="../man/Main.html" flex="1"/>
            <button id="aidegenerale-button" label="Aide générale"/>
          </tabpanel>
        </tabpanels>
      </tabbox>
    </vbox>
  </hbox>

  <!-- ***** BARRE D'OUTILS ****** -->

  <statusbar id="statusbar" align="center">
    <statusbarpanel id="infohint" label="(Pas d'action en cours)"/>
    <statusbarpanel id="blankpanel" flex="1"/>
    <statusbarpanel id="infobdd" label="BDD : Déconnectée" align="start" minwidth="120"/>
  </statusbar>

  </window>
